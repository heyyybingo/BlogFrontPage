(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{623:function(e,a,t){var s=t(3),r=t(624);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var o={insert:"head",singleton:!1},n=s(r,o);if(!r.locals||e.hot.invalidate){var i=r.locals;e.hot.accept(624,(function(){"string"==typeof(r=(r=t(624)).__esModule?r.default:r)&&(r=[[e.i,r,""]]),function(e,a){if(!e&&a||e&&!a)return!1;var t;for(t in e)if(e[t]!==a[t])return!1;for(t in a)if(!e[t])return!1;return!0}(i,r.locals)?(i=r.locals,n(r)):e.hot.invalidate()}))}e.hot.dispose((function(){n()})),e.exports=r.locals||{}},624:function(e,a,t){(a=t(4)(!1)).push([e.i,".userInfo-container .userInfo[data-v-74c0acd3]{background-color:white;display:flex;border-radius:3px;padding:2em}.userInfo-container .userInfo .avatar[data-v-74c0acd3]{border:1px dashed #d9d9d9;border-radius:6px;cursor:pointer;position:relative;overflow:hidden;width:178px;height:178px}@media screen and (max-width: 768px){.userInfo-container .userInfo[data-v-74c0acd3]{display:block}.userInfo-container .userInfo .avatar[data-v-74c0acd3]{margin:0 auto}}\n",""]),e.exports=a},627:function(e,a,t){"use strict";t.r(a),t.d(a,"render",(function(){return s})),t.d(a,"staticRenderFns",(function(){return r}));var s=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"userInfo-container"},[t("el-row",[t("el-col",{attrs:{xs:1,sm:2,md:2,lg:2,xl:2}},[t("span",[e._v(" ")])]),e._v(" "),t("el-col",{staticClass:"main",attrs:{xs:22,sm:20,md:20,lg:20,xl:20}},[t("div",{staticClass:"userInfo"},[t("div",{staticClass:"avatar"},[t("img",{attrs:{src:e.imageUrl,height:"100%",width:"100%"}})]),e._v(" "),t("el-form",{ref:"updateUser",attrs:{model:e.user,rules:e.rules,"label-width":"80px"}},[t("form",{ref:"uploadAvatar",staticStyle:{margin:"0 0 20px 80px"}},[t("input",{attrs:{type:"file",name:"image",disabled:!e.editable},on:{change:e.changeImage}})]),e._v(" "),t("el-form-item",{attrs:{label:"用户名"}},[t("el-input",{attrs:{disabled:!0},model:{value:e.user.userName,callback:function(a){e.$set(e.user,"userName",a)},expression:"user.userName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{attrs:{disabled:!e.editable},model:{value:e.user.password,callback:function(a){e.$set(e.user,"password",a)},expression:"user.password"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"邮箱"}},[t("el-input",{attrs:{disabled:!0},model:{value:e.user.email,callback:function(a){e.$set(e.user,"email",a)},expression:"user.email"}})],1),e._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("提交")]),e._v(" "),t("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.editable,expression:"!editable"}],on:{click:function(a){e.editable=!0}}},[e._v("编辑")]),e._v(" "),t("el-button",{directives:[{name:"show",rawName:"v-show",value:e.editable,expression:"editable"}],on:{click:function(a){e.editable=!1}}},[e._v("取消")])],1)],1)],1)]),e._v(" "),t("el-col",{attrs:{xs:1,sm:2,md:2,lg:2,xl:2}},[t("span",[e._v(" ")])])],1)],1)},r=[];s._withStripped=!0},628:function(e,a,t){"use strict";var s=t(60),r={name:"",data:function(){return{user:{},progress:null,imageUrl:t(61),editable:!1,rules:{password:[{required:!0,message:"请输入密码",trigger:"blue"},{min:3,max:18,message:"长度在3-18之间",trigger:"blur"}]}}},components:{},methods:{loadUserInfo:function(){var e=this;this.editable=!1,console.log("userINfo"),this.axios.post("/user/userInfo").then((function(a){200==a.status&&(e.user=a.data.data,console.log("getUserInfo",e.user),null!==e.user.avatar&&(e.imageUrl=Object(s.a)(e.user.avatar)),console.log(e.user),console.log("imageURL",e.imageUrl))})).catch((function(e){console.log(e)}))},onSubmit:function(){var e=this;this.$refs.updateUser.validate((function(a){a?e.imageUrl!=e.user.avatar?e.UploadAndSub():e.InstantSub():e.$message.error("检查输入")}))},UploadAndSub:function(){var e=this,a=this.$refs.uploadAvatar,t=new FormData(a);console.log(t),this.axios.post("/upload/uploadImage",t,{"Content-type":"multipart/form-data"}).then((function(a){if(a.status=200){e.imageUrl=a.data.data;var t=e.user._id,s=e.imageUrl,r=e.user.password,o=e.user.avatar;return e.axios.post("/user/updateUser",{avatar:s,password:r,_id:t,oldavatar:o})}})).then((function(a){console.log(a);var t=a.data.data;e.$store.dispatch("refreshToken",{token:t}),e.loadUserInfo(),e.$message("修改成功")})).catch((function(e){console.log(e)}))},InstantSub:function(){var e=this,a=this.user._id,t=this.user.password;this.axios.post("/user/updateUser",{password:t,_id:a}).then((function(a){console.log(a);var t=a.data.data;e.$store.dispatch("refreshToken",{token:t}),e.loadUserInfo(),e.$message("修改成功")})).catch((function(e){console.log(e)}))},changeImage:function(e){var a=this;console.log(e);var t=e.target.files[0];if("image/jpeg"==t.type){if(t.size>2097152)this.$message.error("图片小于2m");else{var s=new FileReader;s.readAsDataURL(t),s.onloadend=function(e){a.imageUrl=e.target.result,console.log(a.imageUrl)}}}else this.$message.error("图片需要是jpeg格式")}},created:function(){this.loadUserInfo()}};a.a=r},638:function(e,a,t){"use strict";var s=t(623);t.n(s).a},640:function(e,a,t){"use strict";t.r(a);var s=t(627),r=t(628),o=(t(638),t(2)),n=Object(o.a)(r.a,s.render,s.staticRenderFns,!1,null,"74c0acd3",null),i=t(5);i.install(t(1)),i.compatible&&(e.hot.accept(),i.isRecorded("74c0acd3")?i.reload("74c0acd3",n.options):i.createRecord("74c0acd3",n.options),e.hot.accept(627,function(e){s=t(627),i.rerender("74c0acd3",{render:s.render,staticRenderFns:s.staticRenderFns})}.bind(this))),n.options.__file="src/Views/userInfo.vue",a.default=n.exports}}]);